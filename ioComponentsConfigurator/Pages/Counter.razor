@page "/counter"
@using System.Net.Http.Json
@using ioComponentsConfigurator.Models;

@inject HttpClient httpClient


<MudDrawerContainer Class="mud-height-full">

    <MudDrawer @bind-Open="@openRight" Fixed="false" Anchor="Anchor.Right" Elevation="1" Variant="@DrawerVariant.Persistent" Width="calc((100% - 250px) / 2)">
            <div>
                <h2 style="padding:12px">@SelectedTitle</h2>
                <MudButton OnClick="@SaveNewData" class="d-flex justify-right align-right">Save</MudButton>
            </div>
        </MudDrawer>

   
            <MudDataGrid T="Element" Items="@Elements.Take(4)" RowClick="@RowClicked">
                <Columns>
                    <Column T="Element" Field="Id" Title="Id" />
                    <Column T="Element" Field="Name" />
                </Columns>
            </MudDataGrid>
 

    </MudDrawerContainer>



@code
{
    private IEnumerable<Element> Elements = new List<Element>();

    protected override async Task OnInitializedAsync()
    {
        Elements = new List<Element>()
        {
            new Element() { Id = 1, Name = "test 1" },
            new Element() { Id = 2, Name = "test 2" },
            new Element() { Id = 3, Name = "test 3" },
            new Element() { Id = 4, Name = "test 4" }
        };
        // Elements = await httpClient.GetFromJsonAsync<List<Element>>("webapi/periodictable");
    }

    public string Text { get; set; } = "????";
    public string ButtonText { get; set; } = "Click Me";
    public int ButtonClicked { get; set; }

    public string? SelectedTitle { get; set; }

    void ButtonOnClick()
    {
        ButtonClicked += 1;
        Text = $"Awesome x {ButtonClicked}";
        ButtonText = "Click Me Again";
    }

    [CascadingParameter]
    public bool Rtl { get; set; }


    bool openRight = false;
    void ToggleRightDrawer()
    {
        openRight = !openRight;
    }

    // events
    void RowClicked(DataGridRowClickEventArgs<Element> args)
    {
        // _events.Insert(0, $"Event = RowClick, Index = {args.RowIndex}, Data = {System.Text.Json.JsonSerializer.Serialize(args.Item)}");

        SelectedTitle = args.Item.Name;
        openRight = true;
    }

    void SaveNewData()
    {
        openRight = false;
    }
}
